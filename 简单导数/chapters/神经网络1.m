% ==========================================
% 作业 1：水果图形识别和分类
% ==========================================

% 1. 定义特征数据 (输入层，4个特征 x 3个样本)
% 每一列代表一个样本，顺序：橙子、香蕉、苹果
P = [1.220,  0.7605, 1.6010;  % 颜色
     3,      278,    11;      % 面积
     3,      227,    11;      % 周长
     4.1888, 0.0647, 1.1424]; % 弧度

% 2. 定义目标数据 (输出层，独热编码 3x3矩阵)
% [1;0;0]为橙子, [0;1;0]为香蕉, [0;0;1]为苹果
T = eye(3); 

% 3. 数据归一化 (将数据映射到 [-1, 1] 之间，消除量纲影响)
[Pn, ps] = mapminmax(P); 

% 4. 构建 BP 模式识别神经网络
% 设置隐藏层神经元个数为 5
net1 = patternnet(5);
net1.trainParam.showWindow = false; % 保持控制台整洁，关闭训练UI窗口

% 5. 训练网络
net1 = train(net1, Pn, T);

% 6. 测试网络 (由于只有3个标准样本，我们输入原样本检验网络是否成功“记住”了特征)
Y_pred = net1(Pn);
classes = vec2ind(Y_pred); % 将输出的概率矩阵转换为类别索引

% 输出结果
fruit_names = {'橙子', '香蕉', '苹果'};
disp('--- 作业 1: 水果识别验证结果 ---');
for i = 1:3
    fprintf('输入样本 %d 特征 -> 预测结果: %s (真实: %s)\n', i, fruit_names{classes(i)}, fruit_names{i});
end