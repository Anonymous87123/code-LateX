% 作业3：地中海鲨鱼问题建模，对比战前与战争中的种群变化

tspan = [0 30]; % 仿真时间
x0 = [25; 2];   % 初始值 x1(0)=25, x2(0)=2

% 1. 战前情况 (捕获系数 e=0.3)
ode_prewar = @(t, x) [x(1)*(0.7 - 0.1*x(2)); 
                      x(2)*(-0.8 + 0.02*x(1))];
[t1, x_prewar] = ode45(ode_prewar, tspan, x0);

% 2. 战争中情况 (捕获系数 e=0.1)
ode_war = @(t, x) [x(1)*(0.9 - 0.1*x(2)); 
                   x(2)*(-0.6 + 0.02*x(1))];
[t2, x_war] = ode45(ode_war, tspan, x0);

% 3. 绘制相轨迹图 (Phase Portrait) 进行直观对比
figure;
% 绘制战前轨迹
plot(x_prewar(:,1), x_prewar(:,2), 'b-', 'LineWidth', 1.5); hold on;
% 绘制战争中轨迹
plot(x_war(:,1), x_war(:,2), 'r-', 'LineWidth', 1.5);

% 计算并绘制系统的平衡点 (平均数量中心)
% 战前: dx1/dt=0 -> x2=7; dx2/dt=0 -> x1=40
plot(40, 7, 'b*', 'MarkerSize', 10, 'LineWidth', 2);
% 战争中: dx1/dt=0 -> x2=9; dx2/dt=0 -> x1=30
plot(30, 9, 'r*', 'MarkerSize', 10, 'LineWidth', 2);

title('地中海鲨鱼问题：相轨迹与平衡点对比');
xlabel('食用鱼数量 (x_1)');
ylabel('鲨鱼数量 (x_2)');
legend('战前轨迹 (e=0.3)', '战争中轨迹 (e=0.1)', '战前平均值 (40, 7)', '战争中平均值 (30, 9)');
grid on;

% 在控制台打印解释
disp('【结论分析】');
disp('从图中平衡点可以看出：');
disp('战前 (捕捞强)：食用鱼平均数量为 40，鲨鱼为 7。鲨鱼占比约 14.9%');
disp('战争中 (捕捞弱)：食用鱼平均数量降为 30，鲨鱼升为 9。鲨鱼占比约 23.1%');
disp('这完美解释了表格中战争期间鲨鱼比例明显增加的现象。');